<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Meal Planner</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <h1>Meal Planner</h1>
      <p>Planificador en 3 secciones: calendario, recetas y compra</p>
    </div>

    <nav class="tabs" aria-label="Secciones">
      <button class="tab active" data-tab="plan">Calendario</button>
      <button class="tab" data-tab="recipes">Recetas</button>
      <button class="tab" data-tab="shop">Compra</button>
    </nav>
  </header>

  <main class="container">
    <!-- PLAN -->
    <section id="tab-plan" class="tabpanel active" aria-labelledby="Calendario">
      <div class="plan-head">
        <div class="week-controls">
          <button id="prevWeekBtn" class="btn">← Semana</button>
          <div class="week-title">
            <div class="label">Calendario (2 semanas)</div>
            <div id="weekRange" class="value">—</div>
          </div>
          <button id="nextWeekBtn" class="btn">Semana →</button>
        </div>

        <div class="plan-actions">
          <button id="clearPlanBtn" class="btn danger">Vaciar estas 2 semanas</button>
          <button id="copyPrevWeekBtn" class="btn">Copiar 2 semanas anteriores</button>
        </div>
      </div>

      <div class="grid" id="weekGrid" aria-label="Calendario de dos semanas">
        <!-- Se rellena por JS -->
      </div>

      <div class="hint">
        Tip: haz clic en un hueco (almuerzo/cena) para escribir un plato o asignar una receta guardada.
      </div>
    </section>

    <!-- RECETAS -->
    <section id="tab-recipes" class="tabpanel" aria-labelledby="Recetas">
      <div class="recipes-layout">
        <div class="card">
          <div class="card-title">
            <h2>Buscar ideas de recetas</h2>
            <p class="muted">Sugerencias filtrables: saludable, Thermomix, congelable y tupper.</p>
          </div>

          <div class="search">
            <input type="text" id="searchInput" placeholder="Ej: pollo al curry, lentejas, pasta..." />
            <button id="searchBtn" class="btn primary">Buscar</button>
          </div>

          <div class="filter-row">
            <span class="muted">Filtros:</span>
            <label class="tag-filter"><input type="checkbox" value="saludable"> Saludable</label>
            <label class="tag-filter"><input type="checkbox" value="thermomix"> Thermomix</label>
            <label class="tag-filter"><input type="checkbox" value="congelable"> Congelable</label>
            <label class="tag-filter"><input type="checkbox" value="tupper"> Tupper</label>
          </div>

          <div id="results" class="results" aria-label="Resultados de búsqueda"></div>
        </div>

        <div class="card">
          <div class="card-title">
            <h2>Mis recetas</h2>
            <p class="muted">Guarda ideas, filtra por etiquetas y asígnalas al calendario.</p>
          </div>

          <div class="my-recipes-actions">
            <input type="text" id="myRecipeSearch" class="input" placeholder="Filtrar por nombre..." />
            <select id="myRecipeTag" class="input">
              <option value="all">Todas las etiquetas</option>
              <option value="saludable">Saludable</option>
              <option value="thermomix">Thermomix</option>
              <option value="congelable">Congelable</option>
              <option value="tupper">Tupper</option>
              <option value="rapida">Rápida</option>
            </select>
            <button id="clearRecipesBtn" class="btn danger">Borrar recetas</button>
          </div>

          <div class="inline-form">
            <input type="text" id="customRecipeName" class="input" placeholder="Nueva receta rápida (nombre)" />
            <input type="text" id="customRecipeTags" class="input" placeholder="Etiquetas: saludable, tupper..." />
            <input type="text" id="customRecipeIngredients" class="input" placeholder="Ingredientes (separados por coma)" />
            <input type="text" id="customRecipeUrl" class="input" placeholder="URL de referencia (opcional)" />
            <button id="addCustomRecipeBtn" class="btn primary">Guardar receta</button>
          </div>

          <div id="myRecipes" class="my-recipes" aria-label="Lista de mis recetas"></div>
        </div>
      </div>
    </section>

    <!-- COMPRA -->
    <section id="tab-shop" class="tabpanel" aria-labelledby="Compra">
      <div class="card">
        <div class="card-title">
          <h2>Lista de la compra</h2>
          <p class="muted">Añade ingredientes manualmente o genera desde el plan semanal.</p>
        </div>

        <div class="shop-actions">
          <button id="addFromPlanBtn" class="btn primary">Añadir ingredientes del plan</button>
          <button id="clearShopChecksBtn" class="btn">Desmarcar todo</button>
        </div>

        <div class="shop-form">
          <input type="text" id="shopItemName" class="input" placeholder="Ingrediente" />
          <input type="text" id="shopItemQty" class="input" placeholder="Cantidad (opcional)" />
          <select id="shopItemCategory" class="input">
            <option value="verdura">Verdura</option>
            <option value="fruta">Fruta</option>
            <option value="carne">Carne</option>
            <option value="pescado">Pescado</option>
            <option value="lacteos">Lácteos</option>
            <option value="despensa">Despensa</option>
            <option value="congelados">Congelados</option>
            <option value="bebidas">Bebidas</option>
            <option value="limpieza">Limpieza</option>
            <option value="otros">Otros</option>
          </select>
          <button id="addShopItemBtn" class="btn">Añadir</button>
        </div>

        <div class="suggestions">
          <div class="suggestions-title">Sugerencias rápidas</div>
          <div id="suggestionChips" class="suggestion-chips"></div>
        </div>

        <div id="shoppingList" class="shopping" aria-label="Lista de la compra"></div>
      </div>
    </section>
  </main>

  <!-- MODAL: selector de receta para un slot -->
  <dialog id="pickerDialog" class="dialog">
    <form method="dialog" class="dialog-inner">
      <div class="dialog-head">
        <div>
          <div class="dialog-kicker" id="pickerKicker">—</div>
          <h3 id="pickerTitle">Editar hueco</h3>
        </div>
        <button class="icon-btn" value="cancel" aria-label="Cerrar">✕</button>
      </div>

      <div class="dialog-columns">
        <div class="dialog-block">
          <h4>Escribir plato rápido</h4>
          <input id="slotTextInput" class="dialog-search" type="text" placeholder="Ej: Ensalada de quinoa" />
          <div class="checkbox-row">
            <label><input type="checkbox" id="slotSaveAsRecipe"> Guardar como receta</label>
          </div>
          <input id="slotTagsInput" class="dialog-search" type="text" placeholder="Etiquetas (saludable, tupper, congelable...)" />
          <input id="slotIngredientsInput" class="dialog-search" type="text" placeholder="Ingredientes (separados por coma)" />
          <input id="slotUrlInput" class="dialog-search" type="text" placeholder="URL de referencia (opcional)" />
          <button id="slotSaveBtn" class="btn primary" type="button">Guardar en el hueco</button>
        </div>

        <div class="dialog-block">
          <h4>Mis recetas</h4>
          <input id="pickerSearch" class="dialog-search" type="text" placeholder="Filtrar mis recetas..." />
          <select id="pickerTagFilter" class="dialog-search">
            <option value="all">Todas las etiquetas</option>
            <option value="saludable">Saludable</option>
            <option value="thermomix">Thermomix</option>
            <option value="congelable">Congelable</option>
            <option value="tupper">Tupper</option>
            <option value="rapida">Rápida</option>
          </select>
          <div id="pickerList" class="picker-list"></div>
        </div>
      </div>

      <div class="dialog-foot">
        <button id="removeFromSlotBtn" class="btn danger" value="remove">Quitar del hueco</button>
        <button class="btn" value="cancel">Cancelar</button>
      </div>
    </form>
  </dialog>

  <!-- MODAL: asignar receta a calendario -->
  <dialog id="assignDialog" class="dialog">
    <form method="dialog" class="dialog-inner">
      <div class="dialog-head">
        <div>
          <div class="dialog-kicker">Asignar al calendario</div>
          <h3>Elige día y comida</h3>
        </div>
        <button class="icon-btn" value="cancel" aria-label="Cerrar">✕</button>
      </div>

      <div class="assign-grid">
        <select id="assignDay" class="dialog-search"></select>
        <select id="assignMeal" class="dialog-search">
          <option value="lunch">Almuerzo</option>
          <option value="dinner">Cena</option>
        </select>
      </div>

      <div class="dialog-foot">
        <button id="assignConfirmBtn" class="btn primary" type="button">Asignar</button>
        <button class="btn" value="cancel">Cancelar</button>
      </div>
    </form>
  </dialog>

  <script src="app.js"></script>
</body>
</html>
